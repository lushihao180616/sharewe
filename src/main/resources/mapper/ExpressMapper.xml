<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lushihao.sharewe.dao.ExpressMapper">
    <insert id="createExpress" parameterType="Express"
            useGeneratedKeys="true" keyProperty="id">
		INSERT INTO
			express
			(addressId,buildingId,statusId,sendUserOpenId,deadTime,sendTime)
		VALUES
			(#{addressId},#{buildingId},#{statusId},#{sendUserOpenId},#{deadTime},#{sendTime})
	</insert>
    <update id="updateExpress" parameterType="Express">
		UPDATE
		    express
		SET
		    addressid=#{addressId},
		    buildingid=#{buildingId},
		    statusid=#{statusId},
		    reward=#{reward},
		    senduseropenid=#{sendUserOpenId},
		    getuseropenid=null,
		    deadtime=#{deadTime},
		    sendtime=#{sendTime},
		    gettime=null,
		    getusercomplete=null
		WHERE
		    id=#{id}
	</update>
	<select id="filterExpress" resultType="Express">
		SELECT
			*
		FROM
			express
		WHERE
			statusid=1
		AND
			deadtime&gt;#{nowDate}
		<if test="buildingId != 0">
			AND buildingid=#{buildingId}
		</if>
		<choose>
			<when test="express_lastId != 0">
				LIMIT ${express_lastId},10
			</when>
			<otherwise>
				LIMIT 0,10
			</otherwise>
		</choose>
	</select>
	<update id="getExpress" parameterType="Express">
		UPDATE
		    express
		SET
		    getuseropenid=#{getUserOpenId},
		    gettime=#{getTime},
		    statusid=2
		WHERE
		    id=#{id}
		AND
		    statusid=1
	</update>
    <select id="getOneExpress" parameterType="int" resultType="Express">
        SELECT
            *
        FROM
            express
        WHERE
            id=#{id}
    </select>
	<delete id="deleteExpress" parameterType="int">
        DELETE FROM
            express
        WHERE
            id=#{value}
        AND
            (statusid=1 OR statusid=4)
    </delete>
</mapper>